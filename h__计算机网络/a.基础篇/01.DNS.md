
### 一、概述

- DNS 是域名系统（Domain Name System）的缩写，提供的是域名到 IP 地址之间的解析服务。

### 二、DNS 同时使用 TCP 和 UDP 协议

- 占用端口号：53

- 在区域传输的时候使用 TCP 协议
    - 辅域名服务器会定时（一般3小时）向主域名服务器进行查询以便了解数据是否有变动。如有变动，会执行一次区域传送，进行数据同步
- 在域名解析的时候使用 UDP 协议
    - 客户端向DNS服务器查询域名，一般返回的内容都不超过512字节，用UDP传输即可

### 三、DNS 解析过程

- 首先，在**浏览器缓存**中查找对应的 IP 地址，找到直接返回，找不到继续下一步

- 将请求发送到**本地 DNS 服务器**，本地 DNS 服务器也会在缓存中查找，找到直接返回，找不到继续下一步
- 本地 DNS 服务器向**根域名服务器**发送请求，根域名服务器会返回一个所查询域的顶级域名服务器地址
- 本地 DNS 服务器向**顶级域名服务器**发送请求，接受请求的服务器也会在缓存中查询，如果没有就返回相关的下一级更权限域名服务器地址
- 本地DNS服务器向**权威域名服务器**发送请求，域名服务器返回对应的结果
- 本地 DNS 服务器将结果缓存，并返回给用户

### 四、迭代查询与递归查询

- DNS 解析是一个包含迭代解析和递归解析的过程

- **递归查询**指的是查询请求发出后，域名服务器代为向下一级域名服务器发出请求，最后向用户返回查询的最终结果。使用递归 查询，用户只需要发出一次查询请求
- **迭代查询**指的是查询请求发出后，域名服务器返回单次查询的结果。下一级的查询由用户自己请求。使用迭代查询，用户需要发出 多次的查询请求
- 从解析过程可以看出，用户到本地 DNS 服务器的查询请求是递归查询，而后续的查询请求是迭代查询