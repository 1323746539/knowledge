
### 一、对虚拟 DOM 的理解

- VNode 是一个 js 对象，描述了真实 DOM ，例如

```js
{
  tag: 'div',
  props: { id: 'app' },
  children: [
    { tag: 'span', props: { class: 'text' }, children: 'Hello' }
  ]
}
```
- 框架维护两套虚拟 DOM 树，分别是当前树和新树，数据变化时生成新虚拟 DON 树，通过 diff 算法比较两棵树的差异，然后更新真实 DOM

- 批量更新流程

```js
A[数据变化] --> B[生成新Virtual DOM]
B --> C[Diff算法比较差异]
C --> D[计算最小更新操作]
D --> E[批量更新真实DOM]
```

### 二、核心价值体现

- 性能优化
  - 减少直接操作 DOM 的开销（DOM操作比JS操作慢100+倍）
  - 合并多次数据变更为单次 DOM 更新
- 跨平台能力
  -  抽象渲染层，同一套虚拟DOM可对应不同渲染器（因为虚拟 DOM 就是 js 对象）


### 三、虚拟 DOM 真的比真实 DOM 性能好吗

- 实际上，虚拟DOM的性能优势是有条件的，并非在所有场景下都优于直接DOM操作。毕竟，虚拟DOM的创建和更新过程也会消耗一定的时间和资源。
- 简单对比

|  | 虚拟DOM | 真实DOM |
| --- | --- | --- |
| 首次渲染 | 性能较差，有额外的 diff 开销 | 直接操作较快 |
| 频繁更新渲染 | 批量优化，减少 DOM 操作 | 代价加高 |
| 跨平台 | 抽象层优势 | 无法实现 |

